<div class="relative" id="settings-container">
  <button id="settings-toggle" class="cursor-pointer p-3 focus:outline-none" aria-label="Settings">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-700 dark:text-gray-200" fill="currentColor" viewBox="0 0 16 16">
      <path d="m2.244 13.081.943-2.803H6.66l.944 2.803H8.86L5.54 3.75H4.322L1 13.081zm2.7-7.923L6.34 9.314H3.51l1.4-4.156zm9.146 7.027h.035v.896h1.128V8.125c0-1.51-1.114-2.345-2.646-2.345-1.736 0-2.59.916-2.666 2.174h1.108c.068-.718.595-1.19 1.517-1.19.971 0 1.518.52 1.518 1.464v.731H12.19c-1.647.007-2.522.8-2.522 2.058 0 1.319.957 2.18 2.345 2.18 1.06 0 1.716-.43 2.078-1.011zm-1.763.035c-.752 0-1.456-.397-1.456-1.244 0-.65.424-1.115 1.408-1.115h1.805v.834c0 .896-.752 1.525-1.757 1.525"/>
    </svg>
  </button>

  <div id="settings-panel" class="hidden absolute bottom-full mb-2 left-0 bg-gray-50 dark:bg-neutral-900 rounded-lg shadow-xl p-4 min-w-[320px] z-50">
    <div class="flex flex-col gap-4">
      <!-- Theme Toggle -->
      <div class="flex items-center justify-between">
        <span class="text-sm font-medium text-gray-700 dark:text-gray-300">{{ i18n "theme" }}</span>
        <div class="flex gap-3">
          <button id="reader-theme-btn-light" onclick="setReaderTheme('light')" class="cursor-pointer w-8 h-8 rounded-full border border-gray-300 bg-white hover:ring-2 ring-cyan-500 transition-all focus:outline-none focus:ring-2" aria-label="Light Reader Theme" title="Light"></button>
          <button id="reader-theme-btn-sepia" onclick="setReaderTheme('sepia')" class="cursor-pointer w-8 h-8 rounded-full border border-orange-200 bg-[#f4ecd8] hover:ring-2 ring-cyan-500 transition-all focus:outline-none focus:ring-2" aria-label="Sepia Reader Theme" title="Sepia"></button>
          <button id="reader-theme-btn-dark" onclick="setReaderTheme('dark')" class="cursor-pointer w-8 h-8 rounded-full border border-gray-600 bg-neutral-800 hover:ring-2 ring-cyan-500 transition-all focus:outline-none focus:ring-2" aria-label="Dark Reader Theme" title="Dark"></button>
        </div>
      </div>

      <!-- Font Toggle -->
      <div class="flex items-center justify-between">
        <span class="text-sm font-medium text-gray-700 dark:text-gray-300">{{ i18n "font" }}</span>
        <div class="flex gap-2">
          <button id="reader-font-btn-sans" onclick="setReaderFont('sans')" class="cursor-pointer px-3 py-1.5 text-sm rounded border border-gray-300 dark:border-neutral-600 bg-white dark:bg-neutral-800 text-gray-700 dark:text-gray-200 font-sans hover:bg-gray-100 dark:hover:bg-neutral-700 transition-colors focus:outline-none focus:ring-2 ring-cyan-500">{{ i18n "sans_serif" }}</button>
          <button id="reader-font-btn-serif" onclick="setReaderFont('serif')" class="cursor-pointer px-3 py-1.5 text-sm rounded border border-gray-300 dark:border-neutral-600 bg-white dark:bg-neutral-800 text-gray-700 dark:text-gray-200 font-serif hover:bg-gray-100 dark:hover:bg-neutral-700 transition-colors focus:outline-none focus:ring-2 ring-cyan-500">{{ i18n "serif" }}</button>
        </div>
      </div>

      <!-- Font Size Toggle -->
      <div class="flex items-center justify-between">
        <span class="text-sm font-medium text-gray-700 dark:text-gray-300">{{ i18n "size" }}</span>
        <div class="flex gap-2">
          <button id="reader-size-btn-small" onclick="setReaderFontSize('small')" class="cursor-pointer px-3 py-1.5 text-sm rounded border border-gray-300 dark:border-neutral-600 bg-white dark:bg-neutral-800 text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-neutral-700 transition-colors focus:outline-none focus:ring-2 ring-cyan-500">{{ i18n "small" }}</button>
          <button id="reader-size-btn-medium" onclick="setReaderFontSize('medium')" class="cursor-pointer px-3 py-1.5 text-sm rounded border border-gray-300 dark:border-neutral-600 bg-white dark:bg-neutral-800 text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-neutral-700 transition-colors focus:outline-none focus:ring-2 ring-cyan-500">{{ i18n "medium" }}</button>
          <button id="reader-size-btn-large" onclick="setReaderFontSize('large')" class="cursor-pointer px-3 py-1.5 text-sm rounded border border-gray-300 dark:border-neutral-600 bg-white dark:bg-neutral-800 text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-neutral-700 transition-colors focus:outline-none focus:ring-2 ring-cyan-500">{{ i18n "large" }}</button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const settingsToggle = document.getElementById('settings-toggle');
    const settingsPanel = document.getElementById('settings-panel');

    settingsToggle.addEventListener('click', (e) => {
      e.stopPropagation();
      settingsPanel.classList.toggle('hidden');
    });

    document.addEventListener('click', (e) => {
      if (!settingsPanel.contains(e.target) && !settingsToggle.contains(e.target)) {
        settingsPanel.classList.add('hidden');
      }
    });
  });
</script>
